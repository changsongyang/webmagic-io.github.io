
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Config and control Â· WebMagic Documents</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="xsoup.html" />
    
    
    <link rel="prev" href="results.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../ch1-overview/">
            
                <a href="../ch1-overview/">
            
                    
                    WebMagic Overview
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../ch1-overview/philosophy.html">
            
                <a href="../ch1-overview/philosophy.html">
            
                    
                    Philosophy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../ch1-overview/architecture.html">
            
                <a href="../ch1-overview/architecture.html">
            
                    
                    Architect
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../ch1-overview/component.html">
            
                <a href="../ch1-overview/component.html">
            
                    
                    Components
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../ch2-install/">
            
                <a href="../ch2-install/">
            
                    
                    Install
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../ch2-install/with-maven.html">
            
                <a href="../ch2-install/with-maven.html">
            
                    
                    With maven
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../ch2-install/without-maven.html">
            
                <a href="../ch2-install/without-maven.html">
            
                    
                    Without maven
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../ch2-install/first-project.html">
            
                <a href="../ch2-install/first-project.html">
            
                    
                    First Project
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../ch3-build-source/">
            
                <a href="../ch3-build-source/">
            
                    
                    Build From Source
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../ch3-build-source/git-repo.html">
            
                <a href="../ch3-build-source/git-repo.html">
            
                    
                    Get the Source Code
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../ch3-build-source/import-project.html">
            
                <a href="../ch3-build-source/import-project.html">
            
                    
                    Import Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../ch3-build-source/compile-code.html">
            
                <a href="../ch3-build-source/compile-code.html">
            
                    
                    Build and run examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Basic crawler
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="pageprocessor.html">
            
                <a href="pageprocessor.html">
            
                    
                    Implement PageProcessor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="selectable.html">
            
                <a href="selectable.html">
            
                    
                    Selectable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="results.html">
            
                <a href="results.html">
            
                    
                    Save the results
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.5.4" data-path="spider-config.html">
            
                <a href="spider-config.html">
            
                    
                    Config and control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="xsoup.html">
            
                <a href="xsoup.html">
            
                    
                    Jsoup and Xsoup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="monitor.html">
            
                <a href="monitor.html">
            
                    
                    Monitor with JMX
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../ch5-annotation/">
            
                <a href="../ch5-annotation/">
            
                    
                    Crawler in Annotation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../ch5-annotation/model.html">
            
                <a href="../ch5-annotation/model.html">
            
                    
                    Write Model class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../ch5-annotation/targeturl.html">
            
                <a href="../ch5-annotation/targeturl.html">
            
                    
                    TargetUrl and HelpUrl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../ch5-annotation/extractby.html">
            
                <a href="../ch5-annotation/extractby.html">
            
                    
                    @ExtractBy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../ch5-annotation/extractby-on-class.html">
            
                <a href="../ch5-annotation/extractby-on-class.html">
            
                    
                    @ExtractBy on Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../ch5-annotation/formatter.html">
            
                <a href="../ch5-annotation/formatter.html">
            
                    
                    Formatter of Result
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../ch5-annotation/lifecycle.html">
            
                <a href="../ch5-annotation/lifecycle.html">
            
                    
                    A Complete Sample
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="../ch5-annotation/after-extractor.html">
            
                <a href="../ch5-annotation/after-extractor.html">
            
                    
                    AfterExtractor
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../ch6-custom-componenet/">
            
                <a href="../ch6-custom-componenet/">
            
                    
                    Customize Components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../ch6-custom-componenet/pipeline.html">
            
                <a href="../ch6-custom-componenet/pipeline.html">
            
                    
                    Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../ch6-custom-componenet/scheduler.html">
            
                <a href="../ch6-custom-componenet/scheduler.html">
            
                    
                    Scheduler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../ch6-custom-componenet/downloader.html">
            
                <a href="../ch6-custom-componenet/downloader.html">
            
                    
                    Downloader
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../chx-cases/">
            
                <a href="../chx-cases/">
            
                    
                    Case Study
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../chx-cases/basic-list-target.html">
            
                <a href="../chx-cases/basic-list-target.html">
            
                    
                    The combination of basic page and list links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../chx-cases/js-render-page.html">
            
                <a href="../chx-cases/js-render-page.html">
            
                    
                    Front-end JS rendering page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" >
            
                <span>
            
                    
                    Crawl page
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" >
            
                <span>
            
                    
                    Periodically crawl
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.5" data-path="../chx-cases/ajax.html">
            
                <a href="../chx-cases/ajax.html">
            
                    
                    Incremental Update
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Config and control</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="44-crawler-configuration-start-and-stop">4.4 Crawler configuration, start and stop</h3>
<h4 id="441-spider">4.4.1 Spider</h4>
<p><code>Spider</code> is crawler start entrance. Before starting the crawlers, we need to use a <code>PageProcessor</code> create a Spider object, and then use the <code>run()</code> to start. While other components of the Spider (Downloader, Scheduler, Pipeline) can be set by a set method.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>create(PageProcessor)</td>
<td>Create Spider</td>
<td>spider.create(new GithubRepoProcessor())</td>
</tr>
<tr>
<td>addUrl(String&#x2026;)</td>
<td>Add initial URL</td>
<td>spider.addUrl(&quot;<a href="http://webmagic.io/docs/" target="_blank">http://webmagic.io/docs/</a>&quot;)</td>
</tr>
<tr>
<td>addRequest(Request...)</td>
<td>Add initial Request</td>
<td>spider.addRequest(&quot;<a href="http://webmagic.io/docs/" target="_blank">http://webmagic.io/docs/</a>&quot;)</td>
</tr>
<tr>
<td>thread(n)</td>
<td>n threads open</td>
<td>spider.thread(5)</td>
</tr>
<tr>
<td>run()</td>
<td>starts, blocking the current thread of execution</td>
<td>spider.run()</td>
</tr>
<tr>
<td>start()/runAsync()</td>
<td>asynchronous start, continue with the current thread</td>
<td>spider.start()</td>
</tr>
<tr>
<td>stop()</td>
<td>stop crawler</td>
<td>spider.stop()</td>
</tr>
<tr>
<td>test(String)</td>
<td>crawl a page to test</td>
<td>spider.test(&quot;<a href="http://webmagic.io/docs/" target="_blank">http://webmagic.io/docs/</a>&quot;)</td>
</tr>
<tr>
<td>addPipeline(Pipeline)</td>
<td>add a Pipeline, a Spider can have multiple Pipeline</td>
<td>spider.addPipeline(new ConsolePipeline())</td>
</tr>
<tr>
<td>setScheduler(Scheduler)</td>
<td>Settings Scheduler, a Spider must have at a Scheduler</td>
<td>spider.setScheduler(new RedisScheduler())</td>
</tr>
<tr>
<td>setDownloader(Downloader)</td>
<td>Settings Downloader, a Spider must have at a Downloader</td>
<td>spider.setDownloader(new SeleniumDownloader())</td>
</tr>
<tr>
<td>get(String)</td>
<td>synchronous calls, and direct access to the results</td>
<td>ResultItems result = spider.get(&quot;<a href="http://webmagic.io/docs/" target="_blank">http://webmagic.io/docs/</a>&quot;)</td>
</tr>
<tr>
<td>getAll(String&#x2026;)</td>
<td>synchronous calls, and direct access to a bunch of results</td>
<td>List&lt;ResultItems&gt; results = spider .getAll(&quot;<a href="http://webmagic.io/docs/" target="_blank">http://webmagic.io/docs/</a>&quot;, &quot;<a href="http://webmagic.io/xxx" target="_blank">http://webmagic.io/xxx</a>&quot;)</td>
</tr>
</tbody>
</table>
<h4 id="442-site">4.4.2 Site</h4>
<p>The site itself, some configuration information, such as encoding, HTTP headers, timeout, retry strategies, agents, etc., can be configured by setting <code>Site</code> object.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>setCharset(String)</td>
<td>set the encoding</td>
<td>site.setCharset(&quot;utf-8&quot;)</td>
</tr>
<tr>
<td>setUserAgent(String)</td>
<td>Settings UserAgent</td>
<td>site.setUserAgent(&quot;Spider&quot;)</td>
</tr>
<tr>
<td>setTimeOut(int)</td>
<td>set the timeout in milliseconds</td>
<td>site.setTimeOut(3000)</td>
</tr>
<tr>
<td>setRetryTimes(int)</td>
<td>Settings retries</td>
<td>site.setRetryTimes(3)</td>
</tr>
<tr>
<td>setCycleRetryTimes(int)</td>
<td>Setting cycle retries</td>
<td>site.setCycleRetryTimes(3)</td>
</tr>
<tr>
<td>addCookie(String,String)</td>
<td>add a cookie</td>
<td>site.addCookie(&quot;dotcomt_user&quot;,&quot;code4craft&quot;)</td>
</tr>
<tr>
<td>setDomain(String)</td>
<td>set up the domain name, the domain name to be set later, addCookie only take effect</td>
<td>site.setDomain(&quot;github.com&quot;)</td>
</tr>
<tr>
<td>addHeader(String,String)</td>
<td>add a addHeader</td>
<td>site.addHeader(&quot;Referer&quot;,&quot;<a href="https://github.com" target="_blank">https://github.com</a>&quot;)</td>
</tr>
<tr>
<td>setHttpProxy(HttpHost)</td>
<td>Http proxy settings</td>
<td>site.setHttpProxy(new HttpHost(&quot;127.0.0.1&quot;,8080))</td>
</tr>
</tbody>
</table>
<p>Wherein the loop retry cycleRetry version 0.3.0 is added mechanism.</p>
<p>This mechanism will fail to download url back into the tail of the queue retry until the number of retries to ensure that no leakage grasping for some reason the network page.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="results.html" class="navigation navigation-prev " aria-label="Previous page: Save the results">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="xsoup.html" class="navigation navigation-next " aria-label="Next page: Jsoup and Xsoup">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Config and control","level":"1.5.4","depth":2,"next":{"title":"Jsoup and Xsoup","level":"1.5.5","depth":2,"path":"posts/ch4-basic-page-processor/xsoup.md","ref":"posts/ch4-basic-page-processor/xsoup.md","articles":[]},"previous":{"title":"Save the results","level":"1.5.3","depth":2,"path":"posts/ch4-basic-page-processor/results.md","ref":"posts/ch4-basic-page-processor/results.md","articles":[]},"dir":"ltr"},"config":{"plugins":["ga"],"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"},"pluginsConfig":{"ga":{"configuration":"auto","token":"UA-49956730-1"},"highlight":{},"search":{},"lunr":{"ignoreSpecialCharacters":false,"maxIndexSize":1000000},"sharing":{"all":["facebook","google","instapaper","twitter","weibo"],"facebook":true,"google":false,"instapaper":false,"twitter":true,"vk":false,"weibo":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"theme-default":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"WebMagic Documents","language":"en","gitbook":"*"},"file":{"path":"posts/ch4-basic-page-processor/spider-config.md","mtime":"2017-05-29T10:24:00.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-05-29T10:24:31.005Z"},"basePath":"../..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

